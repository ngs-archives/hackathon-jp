<?xml version="1.0" encoding="UTF-8"?>
<Module>
	<ModulePrefs title="HelloWorld!"
				 description="こんにちは，世界"
					 author_email="iron.nori@gmail.com">
					 <Require feature="opensocial-0.8"/>
	</ModulePrefs>
	<Content type="html" view="home"><![CDATA[
		Hello, World!!
		
	]]></Content>
	<Content type="html" view="profile"><![CDATA[
		Hello, World!!
	]]></Content>
	<Content type="html" view="canvas"><![CDATA[
		Hello, World!!!!!

		<script type="text/javascript">
			function request(){
				var idspec	= opensocial.newIdSpec({"userId":"OWNER","groupId":"FRIENDS"});
				var req 	= opensocial.newDataRequest();
				req.add(req.newFetchPersonRequest("OWNER"),"get_owner");
				
				var params = {}
				params[opensocial.DataRequest.PeopleRequestFields.MAX] = 200;

				req.add(req.newFetchPeopleRequest(idspec,params),"get_friends");
				req.send(response);
			}

			function response(dataResponse){
				var owner	= dataResponse.get("get_owner").getData();
				var friends	= dataResponse.get("get_friends").getData();

				var html = "";
				html += "友達" + friends.length +"人"
				html += "<ul>";
				friends.each(function(person){
					html += "\n";
					html += "<li>";
					html += person.getDisplayName();
					html += " : "
					html += person.getField(opensocial.Person.Field.AGE).toString();
					html += " : "
					html += person.getField(opensocial.Person.Field.THUMBNAIL_URL);
					html += " : "
					html += person.getId();
					html += " : "
					html += (person.isViewer()?"いる!!": "zzz...")
					html += "</li>";
				});
				html += "\n</ul>";
				document.getElementById("message").innerHTML = html;
			}
			gadgets.util.registerOnLoadHandler(request);
		</script>
		<div id="message">
		</div>
	]]></Content>
</Module>
