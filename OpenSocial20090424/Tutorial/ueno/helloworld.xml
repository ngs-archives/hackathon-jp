<?xml version="1.0" encoding="UTF-8"?>
<Module>
	<ModulePrefs title="HelloWorld!"
				 description="こんにちは，世界"
					 author_email="iron.nori@gmail.com">
					 <Require feature="opensocial-0.8"/>
	</ModulePrefs>
	<Content type="html" view="home"><![CDATA[
		Hello, World!!
		
	]]></Content>
	<Content type="html" view="profile"><![CDATA[
		Hello, World!!
	]]></Content>
	<Content type="html" view="canvas"><![CDATA[
		Hello, World!!!!!
		<script type="text/css">
			td { font-size:small;}
		</script>

		<script type="text/javascript">
			function request(){
				var idspec	= opensocial.newIdSpec({"userId":"OWNER","groupId":"FRIENDS"});
				var req 	= opensocial.newDataRequest();
				req.add(req.newFetchPersonRequest("OWNER"),"get_owner");
				
				var params = {}
				params[opensocial.DataRequest.PeopleRequestFields.MAX] = 200;

				req.add(req.newFetchPeopleRequest(idspec,params),"get_friends");
				req.send(response);
			}

			function response(dataResponse){
				var owner	= dataResponse.get("get_owner").getData();
				var friends	= dataResponse.get("get_friends").getData();

				var html = "";
				html = "<ul style='display:inline'>";
				html += "</ul>";
				html += owner.getDisplayName();
				html += owner.getField(opensocial.Person.Field.THUMBNAIL_URL)+"";
				html += "友達" + friends.length +"人"
				html += "<table>";
				
			
				
				html += "<tr>";
				for(i in friends){
					html += "<th>";
					html += i;
					html += "</th>";
				}
				for(i in opensocial.Person.Field){
					html += "<th>";
					html += i;
					html += "</th>";
				}
				html += "</tr>";
				
				friends.each(function(person){

					html += "<tr>";
					for(i in person){
						html+= "<td>";
					//	html+= person[i];
						html+= "</td>";
					}
					for(i in opensocial.Person.Field){
						html+= "<td>";
						html+= person.getField(opensocial.Person.Field[i]);
						html+= "</td>";
					}
					html += "</tr>";
				});
				html += "\n</table>";
				document.getElementById("message").innerHTML = html;
			}
			gadgets.util.registerOnLoadHandler(request);
		</script>
		<div id="message">
		</div>
	]]></Content>
</Module>
