<?xml version="1.0" encoding="UTF-8"?>
<Module>
<ModulePrefs
  title="Google Maps"
  description="Google Maps Gadget"
>
<Require feature="dynamic-height" />
<Require feature="minimessage" />
<Require feature="opensocial-0.8" />
<Require feature="pubsub" />
</ModulePrefs>
<Content type="html" view="home,profile"><![CDATA[
<script type="text/javascript" src="http://d1lzci7p8hi5b7.cloudfront.net/opensocial-jquery.min.js"></script>
<script type="text/javascript">
jQuery(function($) {

  var mapUrl = 'http://hackathon-jp.googlecode.com/svn/trunk/OpenSocial20090424/RPC/gmap.html'

  gadgets.pubsub.subscribe('geo', function(sender, point) {
    console.log(point);
    $('#mapframe').get(0).contentWindow.location.href = mapUrl + '#' + point.lat + ',' + point.lng;
  })
  $('#mapframe').attr('src', mapUrl);

  gadgets.rpc.register('map_geo', function(point) {
    alert(11111);
    console.log(point);
    gadgets.pubsub.publish('geo', point);
  });

});
</script>
<style type="text/css">
#mapframe {
border:0px none;
width:100%;
height:100%;
}
</style>
<iframe id="mapframe" src="http://hackathon-jp.googlecode.com/svn/trunk/OpenSocial20090424/RPC/gmap.html" />
]]></Content>
</Module>
