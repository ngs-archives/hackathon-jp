<?xml version="1.0" encoding="UTF-8"?>
<Module>
  <ModulePrefs title="drink" author_email="yasunnobutya@gmail.com" description="OpenSocial Hackathon 2009-04">
    <Require feature="opensocial-0.8" />
    <Require feature="jquery"/>
    <Require feature="dynamic-height" />
  </ModulePrefs>
  <Content type="html" view="profile"><![CDATA[
<!-- jopensocial -->
<script type="text/javascript" src="http://opensocial02.machu.jp/javascripts/jopensocial/jopensocial.js"></script>
<!-- Fetching People and Friends -->
<div>
  <button onclick='fetchPeople();'>Fetch people and friends</button>
  <div>
    <span id='viewer'></span>
    <ul id='friends'></ul>
  </div>
</div>
<script type='text/javascript'>
function fetchPeople() {
  var req = opensocial.newDataRequest();
  req.add(req.newFetchPersonRequest(opensocial.IdSpec.PersonId.VIEWER), 'viewer');
  var params = {};
  params[opensocial.IdSpec.Field.USER_ID] = opensocial.IdSpec.PersonId.VIEWER;
  params[opensocial.IdSpec.Field.GROUP_ID] = 'FRIENDS';
  var idSpec = opensocial.newIdSpec(params);
  req.add(req.newFetchPeopleRequest(idSpec), 'friends');
  req.send(function(data) {
    var viewer = data.get('viewer').getData();
    document.getElementById('viewer').innerHTML = viewer.getId();
    var friends = data.get('friends').getData();
    document.getElementById('friends').innerHTML = '';
    friends.each(function(friend) {
      document.getElementById('friends').innerHTML += '<li>' + friend.getId() + '</li>';
    });
    gadgets.window.adjustHeight();
  });
}
</script>

<!-- Posting activity -->
<div>
  <input type='text' id='title' />
  <button onclick='postActivity();'>Post activity</button>
  <div id='result_activity'></div>
</div>
<script type='text/javascript'>
function postActivity() {
  var params = {};
  params[opensocial.Activity.Field.TITLE] = document.getElementById('title').value;
  var activity = opensocial.newActivity(params);
  opensocial.requestCreateActivity(
      activity, opensocial.CreateActivityPriority.HIGH, function(response) {
        if (response.hadError()) {
          document.getElementById('result_activity').innerHTML = response.getErrorCode();
        } else {
          document.getElementById('result_activity').innerHTML = 'Succeeded!';
        }
        gadgets.window.adjustHeight();
      });
}
</script>

  ]]></Content>
  <Content type="html" view="home"><![CDATA[
<!-- jopensocial -->
<script type="text/javascript" src="http://opensocial02.machu.jp/javascripts/jopensocial/jopensocial.js"></script>
<!-- Fetching People and Friends -->
<div>
  <button onclick='fetchPeople();'>Fetch people and friends</button>
  <div>
    <span id='viewer'></span>
    <ul id='friends'></ul>
  </div>
</div>
<script type='text/javascript'>
function fetchPeople() {
  var req = opensocial.newDataRequest();
  req.add(req.newFetchPersonRequest(opensocial.IdSpec.PersonId.VIEWER), 'viewer');
  var params = {};
  params[opensocial.IdSpec.Field.USER_ID] = opensocial.IdSpec.PersonId.VIEWER;
  params[opensocial.IdSpec.Field.GROUP_ID] = 'FRIENDS';
  var idSpec = opensocial.newIdSpec(params);
  req.add(req.newFetchPeopleRequest(idSpec), 'friends');
  req.send(function(data) {
    var viewer = data.get('viewer').getData();
    document.getElementById('viewer').innerHTML = viewer.getId();
    var friends = data.get('friends').getData();
    document.getElementById('friends').innerHTML = '';
    friends.each(function(friend) {
      document.getElementById('friends').innerHTML += '<li>' + friend.getId() + '</li>';
    });
    gadgets.window.adjustHeight();
  });
}
</script>

<!-- Posting activity -->
<div>
  <input type='text' id='title' />
  <button onclick='postActivity();'>Post activity</button>
  <div id='result_activity'></div>
</div>
<script type='text/javascript'>
function postActivity() {
  var params = {};
  params[opensocial.Activity.Field.TITLE] = document.getElementById('title').value;
  var activity = opensocial.newActivity(params);
  opensocial.requestCreateActivity(
      activity, opensocial.CreateActivityPriority.HIGH, function(response) {
        if (response.hadError()) {
          document.getElementById('result_activity').innerHTML = response.getErrorCode();
        } else {
          document.getElementById('result_activity').innerHTML = 'Succeeded!';
        }
        gadgets.window.adjustHeight();
      });
}
</script>

  ]]></Content>
</Module>