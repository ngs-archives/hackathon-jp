<?xml version="1.0" encoding="UTF-8" ?>
<Module>
  <ModulePrefs title="OpenSocial FriendsDebug">
    <Require feature="opensocial-0.8"/>
  </ModulePrefs>
  <Content type="html">
  <![CDATA[

     <script type="text/javascript">
      /*
       * Request the OWNER and OWNER's friends.
       */
	function init(){
		var params = {};
		params[opensocial.IdSpec.Field.USER_ID] = opensocial.IdSpec.PersonId.VIEWER;
		params[opensocial.IdSpec.Field.GROUP_ID] = "FRIENDS";
		params[opensocial.IdSpec.Field.NECTWORK_DISTANCE] = 1;

		var idSpec = opensocial.newIdSpec(params);
		var req = opensocial.newDataRequest();
		req.add(req.newFetchPeopleRequest(idSpec),"friends");

		req.send(function(data){
			if(data.hadError()){
				var msg = data.getErrorMessage();
				alert(msg);
			}else{
				var item = data.get("friends");
				if(item.hadError()){
					var code = item.getErrorCode();
					var msg = item.getErrorMessage();
					alert(code + " : " + msg);
				}else{
					var friends = item.getData();
					var target = document.getElementById("target");
					friends.each(function(friend){
						var thumbnailUrl = friend.getField(opensocial.Person.Field.THUMBNAIL_URL);
						var userNickname = friend.getDisplayName()
						target.innerHTML += "<img src='" + thumbnailUrl + "'></img><br />" + userNickName+ "<br />";
					});
				}
			}
		});
	}
	document.getElementById("target").innerHTML = "sssss";
	gadgets.util.registerOnLoadHandler(init);
	</script>
	<div id="target"></div>
  ]]>  </Content>
</Module>