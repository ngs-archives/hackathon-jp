<?xml version="1.0" encoding="UTF-8" ?>
<Module>
  <ModulePrefs title="友達情報取得アプリ">
    <Require feature="opensocial-0.7" />
  </ModulePrefs>
  <Content type="html">
    <![CDATA[
    <script type="text/javascript">
      function init() {
        with (opensocial.DataRequest) {
            var req = opensocial.newDataRequest();
            req.add(req.newFetchPersonRequest(PersonId.OWNER), "owner");
            var searchOpt = {};
            searchOpt[PeopleRequestFields.FILTER] = FilterType.ALL;
            searchOpt[PeopleRequestFields.SORT_ORDER] = SortOrder.NAME;
            req.add(req.newFetchPeopleRequest(Group.OWNER_FRIENDS, searchOpt), "ownerFriends");
            req.send(onLoadComplete);
        }
      }
      function onLoadComplete(dataResponse) {
        var owner = dataResponse.get("owner").getData();
        var owner = dataResponse.get("owner").getData();
      alert(owner.getId());
        var ownerFriends = dataResponse.get("ownerFriends").getData();
        var resultHtml = owner.getDisplayName() + "さんのお友達:"
        resultHtml += "<ul>";
        ownerFriends.each(function(friend) {
          resultHtml += ("<li>" + gadgets.util.escapeString(friend.getDisplayName()) + "</li>");
        });
        resultHtml += "</ul>";
        document.body.innerHTML += resultHtml;
      }
      gadgets.util.registerOnLoadHandler(init);
    </script>
    ]]>
  </Content>
</Module>
