<?xml version="1.0" encoding="UTF-8"?>
<Module>
  <ModulePrefs title="Google ブログ検索 アプリ！！">
    <Require feature="opensocial-0.8"/>
  </ModulePrefs>
  <Content type="html">
	<![CDATA[
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/prototype/1.6.0.3/prototype.js"></script>
	<script type="text/javascript">
			function search () {
				$('mail_list').innerHTML = "";
				var words = $('words').value;
				var url = 'http://blogsearch.google.co.jp/blogsearch_feeds?hl=ja&q='+ words +'&lr=lang_ja&um=1&ie=utf-8&num=30&output=atom';

				//オプション設定
				var params = {};
				params[gadgets.io.RequestParameters.CONTENT_TYPE] = gadgets.io.ContentType.FEED;
				params[gadgets.io.RequestParameters.NUM_ENTRIES] = 30;

				gadgets.io.makeRequest(url, callback ,params);
				gadgets.window.adjustHeight(1000);
			}
			function callback(response) {
				var entry = response.data['Entry'];
				for( var i in entry ){
					if(entry[i]["Title"] != null){
						$('mail_list').innerHTML += "<li><a href=\"" + entry[i]["Link"] + "\" target=\"_blank\" >" + entry[i]["Title"] + "</a></li>";
					}
				}
			}

			function init() {
				$('search').onclick = search;
			}

			gadgets.util.registerOnLoadHandler(init);
	</script>
		<div id="form">
			<h1>ブログ検索</h1>
			<input type="textbox" id="words" class="text" value="OpenSocial" /><button type="submit" id="search">検索</button>
		</div>
		<ul id="mail_list">
		</ul>
	]]>
 </Content>
</Module>
